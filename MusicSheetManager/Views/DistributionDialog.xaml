<Window x:Class="MusicSheetManager.Views.DistributionDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Icon="/Resources/music-sheets-distribute.png"
        Title="Distribute sheets"
        Height="520"
        Width="900"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        ShowInTaskbar="False">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="8" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="10" />
            <RowDefinition Height="*" />
            <RowDefinition Height="10" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Header: icon + title/status + percent -->
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="10" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <Image Width="48"
                   Height="48"
                   VerticalAlignment="Center"
                   Source="{Binding HeaderIcon}" />

            <StackPanel Grid.Column="2" Orientation="Vertical">
                <TextBlock Text="{Binding HeaderTitle}" FontSize="15" FontWeight="Bold" />
                <TextBlock Text="{Binding StatusText}" Foreground="Gray" />
            </StackPanel>

            <TextBlock Grid.Column="3"
                       Text="{Binding PercentText}"
                       VerticalAlignment="Center"
                       Margin="10,0,0,0" />
        </Grid>

        <ProgressBar Grid.Row="2"
                     Height="22"
                     Minimum="0"
                     Maximum="100"
                     Value="{Binding Progress}" />

        <!-- Log entries -->
        <ListView x:Name="LogListView"
                  Grid.Row="4"
                  ItemsSource="{Binding LogEntries}"
                  FontFamily="Consolas"
                  FontSize="12"
                  ScrollViewer.VerticalScrollBarVisibility="Auto"
                  ScrollViewer.HorizontalScrollBarVisibility="Auto">
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="Padding" Value="4,2" />
                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                    <Setter Property="Background" Value="Transparent" />
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Level}" Value="Warning">
                            <Setter Property="Background" Value="#FFFFF2A8" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Level}" Value="Error">
                            <Setter Property="Background" Value="#FFFFC0C0" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </ListView.ItemContainerStyle>

            <ListView.ItemTemplate>
                <DataTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <Image Width="26"
                               Height="26"
                               VerticalAlignment="Center"
                               Source="{Binding Icon}" />

                        <TextBlock Grid.Column="1"
                                   Text="{Binding Text}"
                                   TextWrapping="NoWrap"
                                   VerticalAlignment="Center" />
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <Border Grid.Row="6" BorderThickness="0,1,0,0" BorderBrush="LightGray" Padding="0,10,0,0">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Close" Width="110" IsEnabled="{Binding CanClose}" IsDefault="True" Click="CloseButton_Click" />
            </StackPanel>
        </Border>
    </Grid>
</Window>